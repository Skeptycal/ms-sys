.\"                                      Hey, EMACS: -*- nroff -*-
.\" First parameter, NAME, should be all caps
.\" Second parameter, SECTION, should be 1-8, maybe w/ subsection
.\" other parameters are allowed: see man(7), man(1)
.TH MS-SYS 1 "September 13, 2003"
.\" Please adjust this date whenever revising the manpage.
.\"
.\" Some roff macros, for reference:
.\" .nh        disable hyphenation
.\" .hy        enable hyphenation
.\" .ad l      left justify
.\" .ad b      justify to both left and right margins
.\" .nf        disable filling
.\" .fi        enable filling
.\" .br        insert line break
.\" .sp <n>    insert n+1 empty lines
.\" for manpage-specific macros, see man(7)
.SH NAME
ms-sys \- write Microsoft boot block
.SH SYNOPSIS
.B ms-sys
.RI "[options] [device]"
.SH DESCRIPTION
\fBms-sys\fP is for writing Microsoft compatible boot records.
.SH OPTIONS
A summary of options is included below.
.TP
.B \-h, \-\-help
Show summary of options.
.TP
.B \-1, \-\-fat12
Write a FAT12 floppy boot record to device.
.TP
.B \-2, \-\-fat32nt
Write a FAT32 partition NT boot record to device.
.TP
.B \-3, \-\-fat32
Write a FAT32 partition DOS (Win9x) boot record to device.
.TP
.B \-6, \-\-fat16
Write a FAT16 partition DOS (Win9x) boot record to device.
.TP
.B \-m, \-\-mbr
Write a master boot record to device.
.TP
.B \-w, \-\-write
Write automatically selected boot record to device.
.TP
.B \-k, \-\-keeplabel
Do not reset partition disk label
.TP
.B \-f, \-\-force
Force writing of boot record.
.TP
.B \-v, \-\-version
Show program version.
.P
If ms-sys is started without any options a simple diagnosis will be done on
the given device.
.br
.SH EXAMPLES
.P
Please note that Windows ME is not useful for making standalone bootable
floppies. However, Win9x and DOS works fine with the first two examples.
.P
.B Creating a 1.68 MB bootable floppy
.TP
This example assumes that you have your windows installation mounted at /dosc and also have mtools and fdformat installed.
.P
fdformat /dev/fd0u1680
.br
mformat a:
.br
ms-sys -w /dev/fd0
.br
mcopy /dosc/io.sys a:
.br
mcopy /dosc/msdos.sys a:
.br
mcopy /dosc/command.com a:
.P
.B Creating a bootable 2.8 MB floppy image to use with an el-torito bootable CD
.P
dd if=/dev/zero of=floppy288.img bs=1024 count=2880
.br
/sbin/mkdosfs floppy288.img
.br
ms-sys -1 -f floppy288.img
.br
su
.br
mount -o loop floppy288.img /mnt
.br
cp msdos.sys /mnt/
.br
cp io.sys /mnt/
.br
cp command.com /mnt/
.br
(it might also be a good idea to add a config.sys and autoexec.bat with CDROM support)
.br
umount /mnt
.br
exit
.br
cp floppy288.img cd-files/boot.img
.br
mkisofs -b boot.img -c boot.cat -o cdimage.iso cd\-files
.br
(burn the file cdimage.iso to a CD with cdrecord or another program)
.P
.B  restoring a backup of Win9x or Win ME to a fresh hard disk
.P
Step 1, use GNU parted to create your FAT32 partition and file system:
.P
parted (then create partition and file system)
.P
Step 2, write the MBR:
.P
ms-sys -w /dev/hda
.P
Step 3, write the FAT32 partition boot record:
.P
ms-sys -w /dev/hda1
.P
Step 4, mount your new filesystem:
.P
mount /dev/hda1 /mnt
.P
Step 5, read your backup
.P
cd /mnt; tar -xzvf /path/to/my_windows_backup_file.tgz
.br
.SH ENVIRONMENT
The variables LANG and LC_ALL have  the usual meaning, however there are not
many translations available.
.br
.SH BUGS
There have been reports about unbootable FAT32 partitions created with
"mformat -F c:". The recomended workaround is to use gnu parted to create the
partition instead.
.SH AUTHOR
This manual page was originally written by Gurkan Sengun and since edited by
Henrik Carlqvist. The program ms-sys is mostly written by Henrik Carlqvist,
the file CONTRIBUTORS in the source archive contains a complete list of
contributors.
.SH SEE ALSO
mformat(1)  fdformat(8)  mkdosfs(8)  mkisofs(8)
